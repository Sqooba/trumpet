<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Build Deploy and Run - Trumpet -- HDFS Notification System for Apache Hadoop</title>
  

  <link rel="shortcut icon" href="../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  <link href="../site/css/base.css" rel="stylesheet">
  <link href="../site/css/bootstrap-custom.min.css" rel="stylesheet">
  <link href="../site/css/font-awesome-4.0.3.css" rel="stylesheet">
  <link href="../site/css/highlight.css" rel="stylesheet">

  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script>
  <script src="../site/js/base.js"></script>
  <script src="../site/js/bootstrap-3.0.3.min.js"></script>
  <script src="../site/js/highlight.pack.js"></script>
  <script src="../site/js/jquery-1.10.2.min.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Trumpet -- HDFS Notification System for Apache Hadoop</a>
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
      <ul class="current">
    
        
            <li class="toctree-l1 ">
                <a class="" href="..">Trumpet Home</a>
                
            </li>
        

    
        
            <li class="toctree-l1 ">
                <a class="" href="../changelog/">Changelog</a>
                
            </li>
        

    
        
            <li class="toctree-l1 ">
                <a class="" href="../architecture/">Architecture</a>
                
            </li>
        

    
        
            <li class="toctree-l1 current">
                <a class="current" href="./">Build Deploy and Run</a>
                
                    <ul>
                    
                        <li class="toctree-l3"><a href="#project-structure">Project structure</a></li>
                        
                    
                        <li class="toctree-l3"><a href="#build-it">Build it</a></li>
                        
                            <li><a class="toctree-l4" href="#rpm">RPM</a></li>
                        
                            <li><a class="toctree-l4" href="#compatibility-with-hadoop-260-and-270">Compatibility with Hadoop 2.6.0 and 2.7.0+</a></li>
                        
                    
                        <li class="toctree-l3"><a href="#run-it">Run it</a></li>
                        
                    
                    </ul>
                
            </li>
        

    
        
            <li class="toctree-l1 ">
                <a class="" href="../operations/">Operations</a>
                
            </li>
        

    
        
            <li class="toctree-l1 ">
                <a class="" href="../license/">License</a>
                
            </li>
        

    
</ul>

      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Trumpet -- HDFS Notification System for Apache Hadoop</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
    <li>Build Deploy and Run</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              <h2 id="project-structure">Project structure</h2>
<p>The current project is composed of 3 sub-projects:</p>
<ol>
<li>
<p><a href="../../common"><code>common</code></a><br />
  The <code>common</code> sub-project is where the reusable code is shared across the projects.</p>
</li>
<li>
<p><a href="../../server"><code>server</code></a><br />
  Trumpet server. Build this project to <a href="../build">deploy and run Trumpet</a></p>
</li>
<li>
<p><a href="../../client"><code>client</code></a><br />
  Example of client application, reading from Kakfa and doing someting meaningful.</p>
</li>
<li>
<p><a href="../../docs"><code>docs</code></a><br />
  Where the documentation sits.</p>
</li>
</ol>
<h2 id="build-it">Build it</h2>
<p>This project is based on <a href="http://maven.apache.org">Maven</a>. To build it, you need to ensure 
you have java and maven installed, and then: </p>
<p><code>mvn clean install</code></p>
<p>And you can directly import the project in most of the IDE, too.</p>
<h3 id="rpm">RPM</h3>
<p>Running <code>mvn package</code> (included in <code>install</code>) will also generate an RPM.</p>
<p>The RPM can be transformed in .deb via Alien or FPM (see <a href="https://www.howtoforge.com/converting_rpm_to_deb_with_alien">https://www.howtoforge.com/converting_rpm_to_deb_with_alien</a> 
or <a href="https://github.com/jordansissel/fpm">https://github.com/jordansissel/fpm</a> for more generic conversion) if required.</p>
<h3 id="compatibility-with-hadoop-260-and-270">Compatibility with Hadoop 2.6.0 and 2.7.0+</h3>
<p><a href="https://issues.apache.org/jira/browse/HDFS-7446">HDFS-7446</a>, released as part of 
<a href="https://github.com/aw-altiscale/eco-release-metadata/blob/master/HADOOP/2.7.0/RELEASENOTES.2.7.0.md">Hadoop 2.7.0 release</a>, 
changed the HDFS-Inotify interface. Trumpet is using a 
<a href="../../server/src/main/java/org/apache/hadoop/hdfs/inotify/InotifyCompat.java">compatibility class</a> 
which uses reflection to work around compatibility issues.</p>
<p>Trumpet is tested with 
<em> CDH 5.2
</em> CDH 5.3
<em> HDP 2.2
</em> Hadoop 2.6.0
* Hadoop 2.7.0</p>
<h2 id="run-it">Run it</h2>
<p>Trumpet server is a long running process to run alongside the JournalNode. A <a href="http://www.supervisord.org">supervisord</a> 
<a href="../../server/src/main/config/trumpet-server.ini">config file</a> is also provided if you'd like to use supervisord daemon to launch Trumpet.</p>
<p>Once the RPM (or equivalent) is installed, manually launch Trumpet like this:</p>
<pre><code>$ /opt/trumpet/server/bin/trumpet.sh --zk.connect &lt;zk_ip:2181&gt;
</code></pre>

<p>Note: If you're running CDH, it's highly likely that <code>dfs.journalnode.name.dir</code> is not in <code>/etc/hadoop/conf/hdfs-site.xml</code>. 
You need to pass <code>--dfs.edits.dir</code> parameters to specify manually the directory:</p>
<pre><code>$ /opt/trumpet/server/bin/trumpet.sh --zk.connect &lt;zk_ip:2181&gt; --dfs.edits.dir &lt;root_dir_where_edits_files_are_stored&gt;
</code></pre>

<p>Note #2: <code>&lt;root_dir_where_edits_files_are_stored&gt;</code> should point to the same location than dfs.journalnode.name.dir, 
i.e. excluding <code>current/BP...TODO...</code>.</p>
<p>Or copy <code>/opt/trumpet/server/conf/trumpet-server.ini</code> in <code>/etc/supervisord.d</code> to have have Trumpet 
run as a supervisord process (recommended).</p>
<pre><code>sudo cp /opt/trumpet/server/config/trumpet-server.ini /etc/supervisord.d/
sudo vi /etc/supervisord.d/trumpet-server.ini # update &lt;zk_ip:2181&gt; and potentially add --dfs.edits.dir if not found in /etc/hadood/conf/hdfs-site.xml
sudo supervisorctl reread
sudo supervisorctl add trumpet # will start Trumpet as autostart is turned on
</code></pre>
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../operations/" class="btn btn-neutral float-right" title="Operations"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../architecture/" class="btn btn-neutral" title="Architecture"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
        
      <span><a href="../architecture/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      <span style="margin-left: 15px"><a href="../operations/" style="color: #fcfcfc">Next &raquo;</a></span>
    </span>
</div>

<!--
MkDocs version  : 0.12.2
Docs Build Date : 2015-06-03 09:30:55.181259
-->
</body>
</html>